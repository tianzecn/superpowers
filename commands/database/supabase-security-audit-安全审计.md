---
allowed-tools: Read, Write, Edit, Bash
argument-hint: [审计范围] | --rls | --permissions | --auth | --api-keys | --comprehensive
description: 进行全面的 Supabase 安全审计，包含 RLS 分析和漏洞评估
---

# Supabase 安全审计

进行全面的 Supabase 安全审计，包含 RLS 策略分析和漏洞评估：**$ARGUMENTS**

## 当前安全上下文

- Supabase 访问：用于安全分析和策略审查的 MCP 集成
- RLS 策略：当前行级安全实施和策略有效性
- 认证配置：!`find . -name "*auth*" -o -name "*supabase*" | grep -E "\\.(js|ts|json)$" | head -5` 认证设置
- API 安全：当前 API 密钥管理和访问控制实施

## 任务

执行全面的安全审计，提供漏洞评估和策略优化：

**审计范围**：使用 $ARGUMENTS 专注于 RLS 策略、权限分析、认证安全、API 密钥管理或全面安全审查

**安全审计框架**：
1. **RLS 策略分析** - 审查行级安全策略，测试策略有效性，识别策略缺口，优化策略性能
2. **权限评估** - 分析表权限，审查基于角色的访问，验证权限层级，识别过度授权访问
3. **认证安全** - 审查认证配置，分析 JWT 安全性，验证会话管理，评估多因素认证
4. **API 密钥管理** - 审计 API 密钥使用，审查密钥轮换策略，验证密钥作用域，评估暴露风险
5. **数据保护** - 分析敏感数据处理，审查加密实施，验证数据脱敏，评估备份安全
6. **漏洞扫描** - 识别安全漏洞，评估注入风险，审查 CORS 配置，验证速率限制

**高级功能**：自动化安全测试，策略模拟，漏洞评分，合规检查，安全监控设置。

**合规集成**：GDPR 合规检查，SOC2 要求验证，安全最佳实践执行，审计跟踪分析。

**输出**：全面的安全审计报告，包含漏洞评估、策略建议、安全改进和合规验证。
